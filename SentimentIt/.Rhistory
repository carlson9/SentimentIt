library(devtools);library(roxygen2)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
help(fit_stan)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
data1 <- read.csv('C:/Users/Taishi/Documents/AAAAA/batch170.csv')
fit <- fit_stan(data1)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
data1 <- read.csv('C:/Users/Taishi/Documents/AAAAA/batch170.csv')
fit <- fit_stan(data1)
library(devtools);library(roxygen2)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
data1 <- read.csv('C:/Users/Taishi/Documents/AAAAA/batch170.csv')
fit <- fit_stan(data1)
summary(fit)$summary[grep("b", rownames(summary(fit)$summary)),"mean"]
bs <- summary(fit)$summary[grep("b", rownames(summary(fit)$summary)),"mean"]
workers <- levels(data$worker_id[seq(1,dim(data)[1],by=2)])
evels(data1$worker_id[seq(1,dim(data)[1],by=2)])
levels(data1$worker_id[seq(1,dim(data)[1],by=2)])
levels(data1$worker_id[seq(1,dim(data1)[1],by=2)])
library(devtools);library(roxygen2)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
help(fit_stan)
data <- read.csv('C:/Users/Taishi/Documents/AAAAA/batch170.csv')
fit <- fit_stan(data)
fit <- fit_stan(data)
fit <- fit_stan(data)
library(devtools);library(roxygen2)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
help(fit_stan_square)
library(devtools);library(roxygen2)
setwd("C:/Users/Taishi/Documents/SentimentIt")
current.code <- as.package("SentimentIt")
load_all(current.code)
document(current.code)
help(fit_stan)
help(fit_stan_square)
data <- read.csv('C:/Users/Taishi/Documents/AAAAA/batch170.csv')
fit_square <- fit_stan_square(data)
fit_square <- fit_stan_square(data)
summary(fit)$summary[grep("b", rownames(summary(fit)$summary)), "mean"]
colnames(data)
help(readInData)
load('C:/Users/Taishi/Documents/AAAAA/all_batches_with_dups.RData')
colnames(output)
docInfo2 <- read.table('C:/Users/Taishi/Documents/AAAAA/State_Dept_Torture_1999WithIds',  sep='\t', header=TRUE, quote='\"')
docInfo2 <- docInfo2[-1,]
colnames(docInfo2)
dups <- docInfo2[which(duplicated(docInfo2$ids)),'ids']
docInfo2$ids <- as.numeric(as.character(docInfo2$ids))
docInfo2[which(duplicated(docInfo2$ids)),'ids'] <- 9500:9546
docInfo2 <- docInfo2[order(docInfo2$ids),]
countries <- docInfo2$V1
countries
for(dup in dups){
reps <- which(output$document_id==dup)
for(rep in reps){
if(rep%%2!=0){
tobind <- output[rep:(rep+1),]
tobind[1,'document_id'] <- mapper[i]
}else{
tobind <- output[(rep-1):rep,]
tobind[2,'document_id'] <- mapper[i]
}
output <- rbind(output, tobind)
}
i<-i+1
}
i<-1
mapper<-9500:9546
for(dup in dups){
reps <- which(output$document_id==dup)
for(rep in reps){
if(rep%%2!=0){
tobind <- output[rep:(rep+1),]
tobind[1,'document_id'] <- mapper[i]
}else{
tobind <- output[(rep-1):rep,]
tobind[2,'document_id'] <- mapper[i]
}
output <- rbind(output, tobind)
}
i<-i+1
}
library(rstan)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
data <- output
y <- data$result[seq(1,dim(data)[1],by=2)]
data$document_id
data$document_id_old <- data$document_id
data$document_id <- as.numeric(as.factor(data$document_id))
data$countries
data$country_id_old <- data$countries
data$country_id <- as.numeric(data$country_id_old)
sum(j==nums[1])
data <- read.csv('C:/Users/Taishi/Documents/AAAAA/batch170.csv')
workers <- levels(data$worker_id[seq(1, dim(data)[1], by=2)])
j <- as.numeric(data$worker_id[seq(1,dim(data)[1],by=2)])
sum(j==nums[1])
bs <- summary(fit)$summary[grep("b", rownames(summary(fit)$summary)), "mean"]
workers <- levels(data$worker_id[seq(1, dim(data)[1], by=2)])
j <- as.numeric(data$worker_id[seq(1,dim(data)[1],by=2)])
which(bs<1)
nums <- which(bs<1)
nums
nums[4]
nums[4] <- 200
nums
names(nums)
names(nums)[4] <- "b[6]"
nums
j
names(nums)[4] <- "b[2]"
nums
sum(j==nums[1])
sum(j==nums[2])
table(j)
sum(j==nums[3])
sum(j==nums[4])
sum(j==nums[5])
sum(j==nums[6])
which(j > 50)
which(table(j) > 50)
which(sum(j) > 50)
sum(j)
which(bs < 1 & table(j) > 50)
which(bs < 1 & table(j) > 30)
which(bs < 1 & table(j) > 9)
workers
worker[which(bs < 1 & table(j) > 9)]
workers[which(bs < 1 & table(j) > 9)]
workers[which(bs < 1 & table(j) > 1)]
banning <- function(stan_fit, data){
bs <- summary(fit)$summary[grep("b", rownames(summary(fit)$summary)), "mean"]
workers <- levels(data$worker_id[seq(1, dim(data)[1], by=2)])
j <- as.numeric(data$worker_id[seq(1, dim(data)[1], by=2)])
ban_workers <- workers[which(bs < 1 & table(j) > 100)]
return(ban_workers)
}
banning(fit, data1)
banning(fit_square, data1)
